---
title: "Particle Collision and Handwritten Digits Data Analysis"
author: "Arin Vansomphone"
date: "`r Sys.Date()`"
output: html_document
---
# Loading the Packages
```{r}
library(tidyverse)
library(readr)
```

# Importing and Tidying the Data
```{r warning=FALSE}
particledata <- read_csv("samples_test_175_data.csv")
particledata <- particledata %>%
  select(-...1)

particledata_long <- particledata %>%
  select(-`550 samples`, -`600 samples`, -`650 samples`, -`700 samples`) %>%
  rename(`50` = `50 samples`,
         `100` = `100 samples`,
         `150` = `150 samples`,
         `200` = `200 samples`,
         `250` = `250 samples`,
         `300` = `300 samples`,
         `350` = `350 samples`,
         `400` = `400 samples`,
         `450` = `450 samples`,
         `500` = `500 samples`,) %>%
  pivot_longer(names_to = "samplesize",
               values_to = "percentaccuracy",
               '50' : '500')
particledata_long$samplesize <- as.double(particledata_long$samplesize)
particledata_long
```

# Finding the Summary Statistics
```{r}
particledatastats <- particledata_long %>%
  group_by(samplesize) %>%
  summarize(average = mean(percentaccuracy),
            sd = sd(percentaccuracy),
            min = min(percentaccuracy),
            Q1 = quantile(percentaccuracy, probs = 0.25),
            median = median(percentaccuracy),
            Q3 = quantile(percentaccuracy, probs = 0.75),
            max = max(percentaccuracy),
            IQR = Q3 - Q1) %>%
  arrange(samplesize)
particledatastats
```

# Plotting the Data
```{r}
particledata_long %>%
  ggplot(aes(x = samplesize, y = percentaccuracy)) +
  geom_point() + 
  labs(x = "Sample Size",
       y = "Accuracy (%) for 175 test samples")
```

# Linear Regression Tests
### Weighted least squares
```{r}
x = particledata_long$samplesize
y = particledata_long$percentaccuracy

model <- lm(y ~ x)
```

```{r}
# test for heteroscedasticity
plot(fitted(model), resid(model), xlab = 'Fitted Values', ylab = 'Residual Values')

abline(0,0)
```

```{r}
# breusch-pagan test
library(lmtest)

bptest(model)
```

```{r}
wt <- 1 / lm(abs(model$residuals) ~ model$fitted.values)$fitted.values^2

wls_model <- lm(y ~ x, weights = wt)

summary(wls_model)
```

### Log transformation
```{r}
particledata_long$log_accuracy <- log(particledata_long$percentaccuracy)
particledata_long %>%
  ggplot(aes(x = samplesize, y = log_accuracy)) +
  geom_point() + 
  labs(x = "Sample Size",
       y = "Accuracy (%) for 175 test samples")
```
```{r}
z <- particledata_long$log_accuracy

log_model <- lm(z ~ x)

summary(log_model)
```

### Least squares
```{r}
particledata_long %>%
  ggplot(aes(x = samplesize, y = percentaccuracy)) +
  geom_point() + 
  labs(x = "Sample Size",
       y = "Accuracy (%) for 175 test samples") +
  geom_smooth(se = FALSE, method = "lm")
```
```{r}
x = particledata_long$samplesize
y = particledata_long$percentaccuracy

summary(model)
```

### Model accuracy vs. random guessing
```{r}
particledata500_long <- particledata_long %>%
  filter(samplesize == 500)

t.test(particledata500_long$percentaccuracy, mu = 0.20, alternative = 'greater')
```

# Accuracy Standard Deviation vs. Training Sample Size
```{r}
particledatastats %>%
  ggplot(aes(x = samplesize, y = sd)) + 
  geom_point() +
  labs(x = "Sample Size",
       y = "Standard Deviation of Accuracy (%) for 175 Test Samples") +
  geom_smooth(se = FALSE, method = 'lm')
```

### Statistical test for standard deviation
```{r}
c = particledatastats$sd
d = particledatastats$samplesize
summary(lm(c ~ d))$coefficients
```

# Boxplot graph
### Particle data
```{r}
ggplot(particledata_long, aes(x = samplesize, y = percentaccuracy)) +
  geom_boxplot(aes(group = samplesize)) +
  labs(x = "Sample Size",
       y = "Accuracy (%) for 175 Test Samples")
```

# Comparison with Handwritten Data
### Importing data
```{r warning=FALSE}
handwrittendata <- read_csv("handwrittendigits175testdata.csv")
handwrittendata <- handwrittendata %>%
  select(-...1)

handwrittendata_long <- handwrittendata %>%
  select(-`550 samples`, -`600 samples`, -`650 samples`, -`700 samples`) %>%
  rename(`50` = `50 samples`,
         `100` = `100 samples`,
         `150` = `150 samples`,
         `200` = `200 samples`,
         `250` = `250 samples`,
         `300` = `300 samples`,
         `350` = `350 samples`,
         `400` = `400 samples`,
         `450` = `450 samples`,
         `500` = `500 samples`,) %>%
  pivot_longer(names_to = "samplesize",
               values_to = "percentaccuracy",
               '50' : '500')
handwrittendata_long$samplesize <- as.double(handwrittendata_long$samplesize)
handwrittendata_long
```

### Finding the summary statistics
```{r}
handwrittendatastats <- handwrittendata_long %>%
  group_by(samplesize) %>%
  summarize(average = mean(percentaccuracy),
            sd = sd(percentaccuracy),
            min = min(percentaccuracy),
            Q1 = quantile(percentaccuracy, probs = 0.25),
            median = median(percentaccuracy),
            Q3 = quantile(percentaccuracy, probs = 0.75),
            max = max(percentaccuracy),
            IQR = Q3 - Q1) %>%
  arrange(samplesize)
handwrittendatastats
```

### Plotting the data
```{r}
handwrittendata_long %>%
  ggplot(aes(x = samplesize, y = percentaccuracy)) +
  geom_point() + 
  labs(x = "Sample Size",
       y = "Accuracy (%) for 175 test samples")
```

### Linear regression model
```{r}
handwrittendata_long %>%
  ggplot(aes(x = samplesize, y = percentaccuracy)) +
  geom_point() + 
  labs(x = "Sample Size",
       y = "Accuracy (%) for 175 test samples") +
  geom_smooth(se = FALSE, method = "lm")
```

```{r}
a = handwrittendata_long$samplesize
b = handwrittendata_long$percentaccuracy

handwrittendatamodel <- lm(b ~ a)

summary(handwrittendatamodel)
```

### Box plot
```{r}
ggplot(handwrittendata_long, aes(x = samplesize, y = percentaccuracy)) +
  geom_boxplot(aes(group = samplesize)) +
  labs(x = "Sample Size",
       y = "Accuracy (%) for 175 Test Samples")
```